#BUILD PROPORTIONS OF SPLICING TYPES PLOT
library(ggplot2)
library(wesanderson)
setwd("C:/Users/molen/Desktop/transcriptomics_analysis/Splicing_analysis/splicing_brains_april23") 
list.files("C:/Users/molen/Desktop/transcriptomics_analysis/Splicing_analysis/splicing_brains_april23") 

dsgprop<-read.table("DSG_prop.txt",header=T)
head(dsgprop)

plot<-ggplot(dsgprop, aes(x=comparison,y=number,fill=type)) +
  geom_col(colour="black", position="fill") + 
  scale_y_continuous(labels=scales::percent) + 
  scale_fill_manual(values=wes_palette("Darjeeling1", n = 5)) +
  ylab("% Splicing type") +
  xlab("") + 
  labs(fill="Splicing type") + 
  theme(axis.title.y = element_text(face="bold",size=12)) + 
  theme(legend.title=element_text(face="bold",size=12)) +
  theme(legend.text = element_text(color="black",size=12)) +
  theme(axis.line=element_line(color="black", linewidth=1)) +
  theme(axis.text=element_text(color="black",size=12)) +
  theme(axis.ticks=element_line(linewidth = 1)) +
  theme(axis.ticks.length =unit(0.2, "cm")) +
  theme(panel.background=element_rect(fill="white"))
plot
ggsave("DSGprop.png",plot=plot())

#BUILD NB OF DSG AND DEG PLOT 
library(ggplot2)
library(wesanderson)
setwd("C:/Users/molen/Desktop/transcriptomics_analysis/Splicing_analysis/splicing_brains_april23") 
list.files("C:/Users/molen/Desktop/transcriptomics_analysis/Splicing_analysis/splicing_brains_april23") 

genenb<-read.table("deg&dsg_nb.txt",header=T)
head(genenb)

plot<-ggplot(genenb,aes(x=comparison,y=number,fill=genetype)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values=wes_palette("Darjeeling1", n = 2)) +
  ylab("Gene number") +
  xlab("") + 
  labs(fill="") + 
  scale_x_discrete(limits = c("MvsN", "NvsWt", "WtvsNB1" , "WtvsNB2", "NB1vsNB2")) +
  theme(axis.title.y = element_text(face="bold",size=12)) + 
  theme(legend.title=element_text(face="bold",size=12)) +
  theme(legend.text = element_text(color="black",size=12)) +
  theme(axis.line=element_line(color="black", linewidth=1)) +
  theme(axis.text=element_text(color="black",size=12)) +
  theme(axis.ticks=element_line(linewidth = 1)) +
  theme(axis.ticks.length =unit(0.2, "cm")) +
  theme(panel.background=element_rect(fill="white"))
plot
ggsave("dsgxdeg_nb.png",plot=plot())
